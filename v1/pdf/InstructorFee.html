<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Title</title>

    <style>
        /*reset*/
        body, p, h1, h2, h3, h4, h5, h6, ul, ol, li, dl, dt, dd, table, thead, tbody, tr, th, td, form, fieldset, legend, input, textarea, button {margin:0; padding:0; font-weight:normal}
        table {width:100%; border:0; border-spacing:0; border-collapse:collapse;}
        /*html:first-child select {padding-right:6px; height:20px;} !* Opera 9 & Below Fix *!*/
        option {vertical-align:middle;  padding:3px 0;} /* Firefox Fix */
        legend {display:none; visibility:hidden;}
        img, fieldset, button {vertical-align:middle; border:0;}
        ul, ol {list-style:none;}
        em, address {font-style:normal;}
        hr {display:none; visibility:hidden;}
        article, aside, details, figcaption, figure, footer, header, hgroup, menu, nav, section, summary {display:block; margin: 0; padding: 0; }
        /* 사파리 col width 에러문제로 display 삭제처리함
        caption  {display:block; height: 0; width: 0; font-size: 0; line-height: 0; margin: 0; padding: 0;}*/
        caption  {height: 0; width: 0; font-size: 0; line-height: 0; margin: 0; padding: 0;}
        input, textarea, button {vertical-align: middle;}
        a {text-decoration:none;color:inherit;}
        a:hover, a:active, a:focus{text-decoration:none;}

        /*h3 { padding: 20px 0; text-align: center;}*/
        /*table { border-collapse: collapse; border-spacing: 0; }*/
        /*table thead tr { border-top: 1px solid #000; border-left: 1px solid #000; border-bottom: 1px solid #000;}*/
        /*table thead tr th { padding: 10px; border-right: 1px solid #000; text-align: center; font-size: 12px;}*/
        /*table tbody tr { border-left: 1px solid #000; border-bottom: 1px solid #000;}*/
        /*table tbody tr td { padding: 10px; border-right: 1px solid #000; text-align: center; font-size: 12px;}*/
    </style>
</head>
<body>
    <div id="InstructorFee" style="margin: 10px;"></div>

    <script>
        var data = [
            {
                id: 1,
                title: "보건관리자 신규과정 강사료/교통비 원천징수후 입금내역(8.21 ~ 8.25)",
                items: [
                    { type: "외부", name: "홍길동", ththr: "주식회사 아무개", wnalsqjsgh: "123456-2400000", date: "8월 22일", time: 2, money: 125000, ryxhdql: 38200,
                        thrP: 288200, dnjscjs: 25362, total: 262838, bank: "농협", rPwhkqjsgh: "123-4567-8989-11"
                    },
                    { type: "외부", name: "홍길동", ththr: "주식회사 아무개", wnalsqjsgh: "123456-2400000", date: "8월 22일", time: 2, money: 125000, ryxhdql: 38200,
                        thrP: 288200, dnjscjs: 25362, total: 262838, bank: "농협", rPwhkqjsgh: "123-4567-8989-11"
                    },
                    { type: "외부", name: "홍길동", ththr: "주식회사 아무개", wnalsqjsgh: "123456-2400000", date: "8월 22일", time: 2, money: 125000, ryxhdql: 38200,
                        thrP: 288200, dnjscjs: 25362, total: 262838, bank: "농협", rPwhkqjsgh: "123-4567-8989-11"
                    }
                ]
            },
            {
                id: 2,
                title: "보건관리자 신규과정 강사료/교통비 원천징수후 입금내역(8.21 ~ 8.25)",
                items: [
                    { type: "내부", name: "홍길동", ththr: "주식회사 아무개", wnalsqjsgh: "123456-2400000", date: "8월 22일", time: 2, money: 125000, ryxhdql: null,
                        thrP: 288200, dnjscjs: null, total: 262838, bank: "", rPwhkqjsgh: ""
                    },
                ]
            }
        ];

        document.addEventListener("DOMContentLoaded", () => {
            if(data.length > 0) {
                const dataBody = document.getElementById('InstructorFee');
                let table;

                data.forEach(entry => {
                    const title = document.createElement("h3");
                    title.innerHTML = entry.title;
                    title.style.padding = "20px 0";
                    title.style.textAlign  = "center";

                    table = document.createElement("table");
                    table.innerHTML = `
                            <thead>
                            <tr style="">
                            <th style="padding: 10px; border-left: 1px solid #000; border-top: 1px solid #000; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; font-size: 12px;">구분</th>
                            <th style="padding: 10px; border-top: 1px solid #000; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; font-size: 12px;">이름</th>
                            <th style="padding: 10px; border-top: 1px solid #000; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; font-size: 12px;">소속</th>
                            <th style="padding: 10px; border-top: 1px solid #000; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; font-size: 12px;">주민번호</th>
                            <th style="padding: 10px; border-top: 1px solid #000; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; font-size: 12px;">강의일시</th>
                            <th style="padding: 10px; border-top: 1px solid #000; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; font-size: 12px;">강의시간</th>
                            <th style="padding: 10px; border-top: 1px solid #000; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; font-size: 12px;">강사료</th>
                            <th style="padding: 10px; border-top: 1px solid #000; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; font-size: 12px;">교통비</th>
                            <th style="padding: 10px; border-top: 1px solid #000; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; font-size: 12px;">소계</th>
                            <th style="padding: 10px; border-top: 1px solid #000; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; font-size: 12px;">원천징수액</th>
                            <th style="padding: 10px; border-top: 1px solid #000; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; font-size: 12px;">총계</th>
                            <th style="padding: 10px; border-top: 1px solid #000; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; font-size: 12px;">은행</th>
                            <th style="padding: 10px; border-top: 1px solid #000; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; font-size: 12px;">계좌번호</th>
                            <th style="padding: 10px; border-top: 1px solid #000; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; font-size: 12px;">서명</th>
                            </tr>
                            </thead>
                            <tbody></tbody>
                        `;

                    const tbody = table.querySelector("tbody");

                    // Group rows based on type and store them temporarily
                    let groupedRows = [];
                    let currentGroup = [];
                    let currentType = null;

                    entry.items.forEach((item, index) => {
                        const row = document.createElement("tr");

                        // If the current row's type matches the previous, continue grouping
                        if (currentType === item.type) {
                            currentGroup.push(row);
                        } else {
                            // Store the current group and reset for the next type
                            if (currentGroup.length > 0) {
                                groupedRows.push({ type: currentType, rows: currentGroup });
                            }
                            currentGroup = [row];
                            currentType = item.type;
                        }

                        // If it's the last row, add the current group to groupedRows
                        if (index === entry.items.length - 1) {
                            groupedRows.push({ type: currentType, rows: currentGroup });
                        }

                        row.innerHTML += `
                    <td style="padding: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; font-size: 12px;">${item.name}</td>
                    <td style="padding: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: left; font-size: 12px;">${item.ththr}</td>
                    <td style="padding: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; font-size: 12px;">${item.wnalsqjsgh}</td>
                    <td style="padding: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; font-size: 12px;">${item.date}</td>
                    <td style="padding: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; font-size: 12px;">${item.time}</td>
                    <td style="padding: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: right; font-size: 12px;">${item.money.toLocaleString('ko-KR')}</td>
                    <td style="padding: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: right; font-size: 12px;">${item.ryxhdql !== null ? item.ryxhdql.toLocaleString('ko-KR') : "-"}</td>
                    <td style="padding: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: right; font-size: 12px;">${item.thrP.toLocaleString('ko-KR')}</td>
                    <td style="padding: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: right; font-size: 12px;">${item.dnjscjs !== null ? item.dnjscjs.toLocaleString('ko-KR') : "-"}</td>
                    <td style="padding: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: right; font-size: 12px;">${item.total.toLocaleString('ko-KR')}</td>
                    <td style="padding: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; font-size: 12px;">${item.bank}</td>
                    <td style="padding: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; font-size: 12px;">${item.rPwhkqjsgh}</td>
                    <td style="padding: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; font-size: 12px;"></td>
                `;

                    });

                    // Append grouped rows to the table with rowspan applied
                    groupedRows.forEach(group => {
                        if (group.rows.length > 0) {
                            // Apply rowspan to the first row in each group
                            const typeCell = document.createElement("td");
                            typeCell.style = "padding: 10px; border-right: 1px solid #000; border-left: 1px solid #000; border-bottom: 1px solid #000; text-align: center; font-size: 12px;";
                            typeCell.innerText = group.type; // Set type value
                            typeCell.rowSpan = group.rows.length;
                            group.rows[0].prepend(typeCell); // Add type cell with rowspan to the first row of the group
                        }

                        // Append all rows in the group to tbody
                        group.rows.forEach(row => {
                            tbody.appendChild(row);
                        });
                    });

                    dataBody.append(title);
                    dataBody.append(table);
                });

            }
        });
    </script>
</body>
</html>
