<!doctype html>
<html lang="ko">
    <head>
        <!-- 여기에 head.html을 인클루드 -->
        <meta charset="UTF-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no" />
        <meta name="mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="#8C63E7" />

        <link rel="shortcut icon" href="" />
        <link rel="apple-touch-icon" href="" />
        <link rel="apple-touch-icon-precomposed" href="" />
        <link rel="icon" href="" type="image/x-icon" />

        <meta name="Description" content="" />
        <meta name="Keywords" content="" />
        <meta name="Copyright" content="" />
        <meta content="" property="og:title" />
        <meta content="" property="og:description" />
        <meta content="" property="og:url" />
        <meta content="" property="og:site-name" />

        <link rel="stylesheet" href="../css/reset2.css" />
        <link rel="stylesheet" href="../css/admin/root_admin.css" />
        <!--<link rel="stylesheet" href="../css/root.css">-->
        <link rel="stylesheet" href="../css/kendo/2022.1.119/kendo.common.min.css" />
        <!--    <link rel="stylesheet" href="../css/font.css">-->
        <link rel="stylesheet" href="../css/pd_kendo.css" />
        <link rel="stylesheet" href="../css/common.css" />
        <link rel="stylesheet" href="../css/util.css" />
        <!--    <link rel="stylesheet" href="../css/style2.css">-->
        <link rel="stylesheet" href="../css/admin/admin.css" />
        <link rel="stylesheet" href="../css/guide.css" />
        <link rel="stylesheet" href="../css/media2.css" />

        <script src="../js/jquery/jquery-3.7.1.min.js"></script>
        <script src="../js/kendo/2022.1.119/kendo.all.min.js"></script>
        <script src="../js/kendo/2022.1.119/cultures/kendo.culture.ko-KR.min.js"></script>
        <script src="../js/kendo/kendo.messages.ko-KR.js"></script>
        <script src="../js/common2.js"></script>
        <script src="../js/front/frontUi.js"></script>
        <script src="../js/front/front.js"></script>

        <link rel="stylesheet" href="../js/prism.css" />
        <script src="../js/prism.js"></script>

        <title>Kendo Ui - 사용자</title>

        <link rel="stylesheet" href="../css/style2.css" />
    </head>
    <body>
        <!-- 자동완성 방지용  -->
        <input type="text" title="자동완성 방지용" style="width: 0; height: 0; position: absolute" />
        <input type="password" title="자동완성 방지용" style="width: 0; height: 0; position: absolute" />
        <!-- 자동완성 방지용  -->

        <div class="wrap">
            <!--    Header START    -->
            <!-- 여기에 Header.html을 인클루드 -->
            <header class="left-header">
                <div class="left-header-top">
                    <h1 class="logo">
                        <a href="index.html">Kendo UI</a>
                    </h1>
                    <a href="../../index.html">처음으로</a>
                </div>
                <nav class="left-header-menu-wrap">
                    <ul>
                        <li class="comm">
                            <span class="tab">버전</span>
                            <ol>
                                <li class="comm-scr2018"><a href="comm_scr.html#2018" data-hash="#2018">2018</a></li>
                                <li class="comm-scr2022"><a href="comm_scr.html#2018" data-hash="#2018">2022</a></li>
                                <li class="comm-scr2023"><a href="comm_scr.html#2023" data-hash="#2023">2023</a></li>
                                <li class="comm-scr2025"><a href="comm_scr.html#2025" data-hash="#2025">2025</a></li>
                            </ol>
                        </li>
                        <li class="admin-kendoUi">
                            <a href="javascript: void(0);" class="tab">Admin</a>
                            <ol>
                                <li class="admin-liUpload"><a href="admin_kendoUi.html" data-hash="#upload">Upload</a></li>
                                <li class="admin-liMulti"><a href="admin_kendoUi_multi.html" data-hash="#multiselect">MultiSelect</a></li>
                                <li class="admin-liGrid"><a href="admin_kendoUi_grid.html" data-hash="#gridFilterTooltip">Grid</a></li>
                                <li class="admin-liIcons"><a href="admin_kendoUi_icons.html" data-hash="#icons">Icons</a></li>
                                <li class="admin-liDatePicker"><a href="admin_kendoUi_date.html" data-hash="#datePicker">DatePicker</a></li>
                                <li class="admin-liTime"><a href="admin_kendoUi_time.html" data-hash="#dateTimePicker">DateTimePicker</a></li>
                                <li class="admin-liRange"><a href="admin_kendoUi_range.html" data-hash="#dateRangePicker">DateRangePicker</a></li>
                                <!--                    <li class="liCalendar"><a href="kendoUi_calendar.html" data-hash="#calendar">Calendar</a></li>-->
                                <li class="admin-liNumeric"><a href="admin_kendoUi_numeric.html" data-hash="#numericTextBox">NumericTextBox</a></li>
                                <li class="admin-liDropDown"><a href="admin_kendoUi_dropDown.html" data-hash="#dropDownList">DropDownList</a></li>
                                <li class="admin-liPaging"><a href="admin_kendoUi_paging.html" data-hash="#paging">Paging</a></li>
                                <li class="admin-liEditor"><a href="admin_kendoUi_editor.html" data-hash="#editor">Editor</a></li>
                                <li class="admin-liTree"><a href="admin_kendoUi_tree.html" data-hash="#kendoTree">Kendo Tree</a></li>
                            </ol>
                        </li>
                        <li class="eight kendoUi">
                            <a href="javascript: void(0);" class="tab">사용자</a>
                            <ol>
                                <li class="liUpload"><a href="kendoUi.html" data-hash="#upload">Upload</a></li>
                                <li class="liGrid"><a href="kendoUi_grid.html" data-hash="#gridFilterTooltip">Grid</a></li>
                                <li class="liIcons"><a href="kendoUi_icons.html" data-hash="#icons">Icons</a></li>
                                <li class="liDatePicker"><a href="kendoUi_date.html" data-hash="#datePicker">DatePicker</a></li>
                                <li class="liTime"><a href="kendoUi_time.html" data-hash="#dateTimePicker">DateTimePicker</a></li>
                                <!--                    <li class="liRange"><a href="kendoUi_range.html" data-hash="#dateRangePicker">DateRangePicker</a></li>-->
                                <!--                    <li class="liCalendar"><a href="kendoUi_calendar.html" data-hash="#calendar">Calendar</a></li>-->
                                <li class="liNumeric"><a href="kendoUi_numeric.html" data-hash="#numericTextBox">NumericTextBox</a></li>
                                <li class="liDropDown"><a href="kendoUi_dropDown.html" data-hash="#dropDownList">DropDownList</a></li>
                                <li class="liPaging"><a href="kendoUi_paging.html" data-hash="#paging">Paging</a></li>
                                <li class="liEditor"><a href="kendoUi_editor.html" data-hash="#editor">Editor</a></li>
                                <li class="liTree"><a href="kendoUi_tree.html" data-hash="#kendoTree">Kendo Tree</a></li>
                            </ol>
                        </li>
                        <!--            <li class="eight sample">-->
                        <!--                <a href="javascript: void(0);" class="tab">sample</a>-->
                        <!--                <ol>-->
                        <!--                    <li class="likendoPopup"><a href="sp_kendoPopup.html">kendo Popup</a></li>-->
                        <!--                </ol>-->
                        <!--            </li>-->
                    </ul>
                </nav>
            </header>

            <!--        <div id="header" data-include-path="header.html"></div>-->
            <!--    Header END    -->

            <!--    본문영역 START    -->
            <main class="body-container">
                <!--        breadcrumb START        -->
                <section class="breadcrumb">
                    <div class="container">
                        <ul class="menu">
                            <li>
                                <a href="index.html"><i class="icon-home"></i></a>
                            </li>
                            <li>Kendo Ui</li>
                        </ul>
                    </div>
                </section>
                <!--        breadcrumb END        -->

                <section class="sec-">
                    <div class="container">
                        <div class="top-title-box">
                            <h2>Kendo Ui</h2>
                        </div>

                        <div class="flex-group">
                            <article id="dropDownList" class="article-">
                                <h3 class="title"># Calendar</h3>

                                <div class="sec-cont pd-mt30">
                                    <div class="">
                                        <div id="scheduler" class="kendo-cus-schedule"></div>

                                        <div class="accordion-wrap pd-mt30">
                                            <div class="accordion-head">
                                                <strong>코드 보기</strong>
                                            </div>
                                            <div class="accordion-body">
                                                <div class="g-code-box">
                                                    <pre data-src="code/kendoUi_07.html"></pre>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!--                        //    -->
                                </div>
                            </article>
                            <!--                // dropDownList End    -->

                            <div class="guid-table-box">
                                <div class="guid-table-fixed">
                                    <strong>Class</strong>
                                    <strong>내용</strong>
                                </div>
                                <ul id="guidClass"></ul>
                            </div>
                        </div>
                    </div>
                </section>
            </main>
            <!--    본문영역 END    -->

            <!--    Footer START    -->
            <!--    Footer END    -->

            <script id="event-template" type="text/x-kendo-template">
                <div class="event-box evnet-category-#: id #">
                    <span class="circle scheduler-circle-#: id #"><i class="blind">#: lrgClasfNm #</i></span>
                    <div class="event-tit"><a href="#: url #?OPEN_NUM=#: openNum #" target="_blank">#: title #</a></div>
                </div>
            </script>

            <script id="mobile-event-template" type="text/x-kendo-template">
                <div class="event-box evnet-category-#: id #">
                    <span class="circle scheduler-circle-#: id #"><a href="#: url #?OPEN_NUM=#: openNum #" target="_blank"><i class="blind">#: lrgClasfNm # #: title #</i></a></span>
                </div>
            </script>

            <script>
                var now = new Date();
                var nowYear = now.getFullYear();
                var mon = '';
                // var day = "";
                if (now.getMonth() + 1 < 10) {
                    mon = '0' + (now.getMonth() + 1);
                } else {
                    mon = now.getMonth() + 1;
                }
                if (now.getDate() < 10) {
                    day = '0' + now.getDate();
                } else {
                    day = now.getDate();
                }
                var nowDay = now.getFullYear() + '' + mon + '' + day;
                var toFilter = true;
                var yearMon = nowYear + mon;
                var schedulerDataSource;
                var colorDataSource;
                var sideBarDataSource;
                var cdColorDataSource = new Array();
                var companyId;

                var currentPath = window.location.pathname;
                var currentHash = window.location.hash;

                $(function () {
                    kendo.culture('ko-KR');

                    $('.kendoUi .liCalendar a').addClass('active');

                    // Calendar
                    schedulerDraw(yearMon);

                    var html = '';
                    var guidData = [{ classNm: 'pd-k-sel-center', cont: 'select 텍스트 가운데 정렬' }];

                    for (var i = 0; i < guidData.length; i++) {
                        html += '<li>';
                        html += "   <p class='left'>" + guidData[i].classNm + '</p>';
                        html += "   <p class='right'>" + guidData[i].cont + '</p>';
                        html += '</li>';
                    }

                    $('#guidClass').html(html);
                });

                function schedulerDraw(yearMon, mdClasfCd) {
                    if (mdClasfCd == 'null' || mdClasfCd == 'undefined' || mdClasfCd == undefined) {
                        mdClasfCd = '';
                    }

                    $('#yearMon').val(yearMon);

                    var data = [
                        {
                            OPEN_NUM: 487,
                            SUBJECT_NUM: '310',
                            SUBJECT_NAME: '30분 자막 테스트',
                            TRAINING_CODE: 'A',
                            TRAINING_NM: '인터넷',
                            LRG_CLASF_CD: 'A',
                            LRG_CLASF_NM: '근로자정기교육',
                            START: '2024-08-01',
                            END: '2024-08-01',
                            TODAY: '2024.08.28 16:32',
                            ONTM_YN: 'N',
                            CHASU: 1,
                            ATTEND_STATE_CODE: '5',
                        },
                        {
                            OPEN_NUM: 493,
                            SUBJECT_NUM: '313',
                            SUBJECT_NAME: 'PDF 학습창 테스트',
                            TRAINING_CODE: 'A',
                            TRAINING_NM: '인터넷',
                            LRG_CLASF_CD: 'A',
                            LRG_CLASF_NM: '근로자정기교육',
                            START: '2024-08-01',
                            END: '2024-08-01',
                            TODAY: '2024.08.28 16:32',
                            ONTM_YN: 'N',
                            CHASU: 1,
                            ATTEND_STATE_CODE: '5',
                        },
                        {
                            OPEN_NUM: 461,
                            SUBJECT_NUM: '140',
                            SUBJECT_NAME: '[혼합] 2023년도 관리감독자 법정교육(건설업) - 16시간',
                            TRAINING_CODE: 'B',
                            TRAINING_NM: '집체',
                            LRG_CLASF_CD: 'B',
                            LRG_CLASF_NM: '관리감독자 교육',
                            START: '2024-08-13',
                            END: '2024-08-13',
                            TODAY: '2024.08.28 16:32',
                            ONTM_YN: 'Y',
                            CHASU: 17,
                            ATTEND_STATE_CODE: '2',
                        },
                        {
                            OPEN_NUM: 494,
                            SUBJECT_NUM: '314',
                            SUBJECT_NAME: '비대면 PDF 테스트',
                            TRAINING_CODE: 'G',
                            TRAINING_NM: '비대면',
                            LRG_CLASF_CD: 'A',
                            LRG_CLASF_NM: '근로자정기교육',
                            START: '2024-08-23',
                            END: '2024-08-23',
                            TODAY: '2024.08.28 16:32',
                            ONTM_YN: 'Y',
                            CHASU: 1,
                            ATTEND_STATE_CODE: '2',
                        },
                        {
                            OPEN_NUM: 488,
                            SUBJECT_NUM: '311',
                            SUBJECT_NAME: '세션체크 테스트과정',
                            TRAINING_CODE: 'B',
                            TRAINING_NM: '집체',
                            LRG_CLASF_CD: 'B',
                            LRG_CLASF_NM: '관리감독자 교육',
                            START: '2024-08-26',
                            END: '2024-08-26',
                            TODAY: '2024.08.28 16:32',
                            ONTM_YN: 'Y',
                            CHASU: 1,
                            ATTEND_STATE_CODE: '3',
                        },
                    ];

                    colorDataSource = [
                        { row: 1, color: '#008575' },
                        { row: 2, color: '#454EBF' },
                        { row: 3, color: '#D23325' },
                        { row: 4, color: '#9275F3' },
                    ];

                    schedulerDataSource = new kendo.data.DataSource({
                        data: data,
                        schema: {
                            data: 'items',
                            model: {
                                id: 'OPEN_NUM',
                                fields: {
                                    COMPANYID: { from: 'COMPANYID', type: 'number' },
                                    OPEN_NUM: { from: 'OPEN_NUM', type: 'number' },
                                    SUBJECT_NUM: { from: 'SUBJECT_NUM', type: 'number' },
                                    EDU_SDATE: { from: 'EDU_SDATE', type: 'string' },
                                    EDU_EDATE: { from: 'EDU_EDATE', type: 'string' },
                                    start: { from: 'EDU_START', type: 'date' },
                                    end: { from: 'EDU_END', type: 'date' },
                                    SUBJECT_NAME: { from: 'SUBJECT_NAME', type: 'string' },
                                    LRG_CLASF_CD: { from: 'LRG_CLASF_CD', type: 'string' },
                                    MD_CLASF_CD: { from: 'MD_CLASF_CD', type: 'string' },
                                    SML_CLASF_CD: { from: 'SML_CLASF_CD', type: 'string' },
                                    TODAY: { type: 'date' },
                                    TRAINING_CODE: { from: 'TRAINING_CODE', type: 'string' },
                                    EDU_COST: { type: 'number' },
                                    OFL_EDU_COST: { type: 'number' },
                                    APPLICANT: { type: 'string' },
                                    OFL_APPLICANT: { type: 'string' },
                                    ON_APL_STS: { from: 'ON_APL_STS', type: 'string' },
                                    OFL_APL_STS: { from: 'OFL_APL_STS', type: 'string' },
                                    ISTR_NM: { type: 'string' },
                                    APPLY_PERIOD: { type: 'string' },
                                    TRAINING_NM: { type: 'string' },
                                },
                            },
                        },
                        serverFiltering: false,
                        serverSorting: false,
                    });

                    schedulerDataSource.read();

                    schedulerDataSource.fetch(function () {
                        var view = schedulerDataSource.view();

                        console.log(view);

                        //교육시작일 기준
                        schedulerRoad(view);
                    });
                }

                function schedulerRoad(dataSource) {
                    var schedulerDataSource = [];
                    var colorValId = '';
                    for (var i = 0; i < dataSource.length; i++) {
                        for (var a = 0; a < cdColorDataSource.length; a++) {
                            if (dataSource[i].LRG_CLASF_CD == cdColorDataSource[a].LRG_CLASF_CD) {
                                colorValId = cdColorDataSource[a].rowId;
                            }
                        }

                        var urlData = '';
                        if (companyId == 4) {
                            urlData = '/service/em/sbjct_apply_detail_info_main_global.do';
                        } else if (companyId == 3) {
                            urlData = '/service/em/sbjct_apply_detail_info_main_office.do';
                        } else {
                            urlData = '/service/emapply/page/sbjct_apply_detail_info_main.do';
                        }

                        schedulerDataSource.push({
                            id: colorValId,
                            openNum: dataSource[i].OPEN_NUM,
                            start: dataSource[i].start,
                            end: dataSource[i].start,
                            title: dataSource[i].SUBJECT_NAME,
                            url: urlData,
                            code: dataSource[i].LRG_CLASF_CD,
                            lrgClasfNm: dataSource[i].LRG_CLASF_NM,
                        });
                    }
                    var schedulerDataSource2 = new kendo.data.SchedulerDataSource({
                        data: schedulerDataSource,
                        schema: {
                            model: {
                                id: 'openNum',
                                fields: {
                                    id: { from: 'id', type: 'strong' },
                                    openNum: { from: 'openNum', type: 'number' },
                                    code: { from: 'code', type: 'number' },
                                    title: { from: 'title', defaultValue: 'No title', validation: { required: true } },
                                    start: { type: 'date', from: 'Start' },
                                    end: { type: 'date', from: 'End' },
                                    url: { type: 'string', from: 'url' },
                                },
                            },
                        },
                    });

                    // console.log(schedulerDataSource2);

                    var today = new Date();

                    // $("#scheduler").empty();
                    // $("#scheduler").empty();
                    if (!$('#scheduler').data('kendoScheduler')) {
                        $('#scheduler').kendoScheduler({
                            editable: false,
                            date: today,
                            mobile: true,
                            views: [
                                {
                                    type: 'month',
                                    selected: true,
                                    // selectedDateFormat: "{0:MM.yyyy}",
                                    selectedDateFormat: '{0:yyyy.MM}',
                                    dayTemplate: kendo.template("<span class='k-link k-nav-day'>#= kendo.toString(date, ' d ') #</span>"),
                                    eventsPerDay: 3,
                                    eventTemplate: $('#event-template').html(),
                                },
                            ],
                            navigate: function (e) {
                                toFilter = true;
                                yearMon = kendo.toString(e.date, 'yyyyMM');
                                var scheduler = $('#scheduler').data('kendoScheduler');

                                $('#yearMon').val(yearMon);
                            },
                            dataBound: function (e) {
                                var scheduler = $('#scheduler').data('kendoScheduler');

                                // schFilter(e);

                                var cssLeft = '';
                                var csstop = '';
                                var cssColor = '';
                                var classNm2 = '';

                                $('#scheduler tr td').find('.blind').remove();
                                $('#scheduler .k-today').append("<span class='blind'>오늘</span>");

                                $('#scheduler .k-more-events').each(function (idx, val) {
                                    cssLeft = $(this).css('left').split('px');
                                    csstop = $(this).css('top').split('px');
                                    $(this).css({
                                        width: '21px',
                                        left: Number(cssLeft[0]) + 125 + 'px',
                                        top: Number(csstop[0]) + 25 + 'px',
                                    });

                                    $(this).attr('tabindex', 0);
                                    $(this)
                                        .html("<span class='blind'>more</span><i class='icon icon-plus-s' tabindex='0'></i>")
                                        .attr('data-uid', $(this).prev().data('uid'))
                                        .click(function (e) {
                                            var event = scheduler.occurrenceByUid($(this).attr('data-uid'));
                                            var wrap = $('<div>').addClass('more-event-popup');
                                            var uid = $(this).attr('data-uid');
                                            var top = parseInt($(this).offset().top) + parseInt($(this).css('height')),
                                                left = $(this).offset().left;

                                            e.stopPropagation();

                                            wrap.append(
                                                $('<div>')
                                                    .addClass('mask')
                                                    .css({
                                                        'z-index': 91,
                                                        position: 'fixed',
                                                        top: 0,
                                                        left: 0,
                                                        width: '100%',
                                                        height: '100%',
                                                    })
                                                    .on('click', function () {
                                                        $('.more-event-popup, .more-event-popup-wrap').remove();
                                                    }),
                                            );

                                            wrap.css({
                                                position: 'fixed',
                                                top: 0,
                                                left: 0,
                                                width: '100%',
                                                height: '100%',
                                                'z-index': 90,
                                            });
                                            var wrap2 = $('<div>').addClass('more-event-popup-wrap').css({
                                                top: top,
                                                left: left,
                                                'z-index': 921,
                                                position: 'absolute',
                                            });

                                            wrap2.empty();
                                            var data = schedulerDataSource2.options.data;
                                            // var yearData = yearDataSource.data();
                                            // for (var i in yearData) {
                                            //     if (yearData[i].start == event.start.dateFormat('yyyy-MM-dd')) {

                                            var wrap2Html = '';
                                            var str = '';

                                            wrap2Html += "<div class='head-box'>";
                                            wrap2Html += '  <strong>' + kendo.toString(event.start, 'yyyy.MM.dd') + '</strong>';
                                            wrap2Html +=
                                                "  <button type='button' class='more-popup-close'" + ' onclick=\'morePopupClose(this, "' + uid + '");\'>' + "<span class='blind'>닫기</span></button>";
                                            wrap2Html += '</div>';
                                            wrap2.append(wrap2Html);
                                            for (var i = 0; i < data.length; i++) {
                                                if (data[i].start != '') {
                                                    //console.log(i);
                                                    // console.log("data["+i+"]: "+data[i].start+"event.start: "+event.start);
                                                    // console.log(event.start);
                                                    if (getFormatDate(data[i].start) == getFormatDate(event.start)) {
                                                        for (var a = 0; a < cdColorDataSource.length; a++) {
                                                            if (data[i].LRG_CLASF_CD == cdColorDataSource[a].LRG_CLASF_CD) {
                                                                classNm2 = 'scheduler-circle-' + cdColorDataSource[a].rowId;
                                                            }
                                                        }

                                                        if (data[i].MD_CLASF_NM != null) {
                                                            str =
                                                                "<span class='circle " +
                                                                classNm2 +
                                                                "'>" +
                                                                "<span class='blind'>" +
                                                                data[i].LRG_CLASF_NM +
                                                                ' > ' +
                                                                '' +
                                                                data[i].MD_CLASF_NM +
                                                                '</span></span>';
                                                        } else {
                                                            str = "<span class='circle " + classNm2 + "'>" + "<span class='blind'>" + data[i].LRG_CLASF_NM + '</span></span>';
                                                        }

                                                        // console.log("i: "+i);
                                                        wrap2.append(
                                                            $('<a>')
                                                                .attr('href', '<%=com.podosw.web.util.ServletUtils.getContextPath(request)%>' + data[i].url + '?OPEN_NUM=' + data[i].openNum)
                                                                .addClass('items calender-cont')
                                                                .html('' + '<span class="title">' + data[i].title + '</span>'),
                                                        );
                                                    }
                                                }
                                            }
                                            $('body').append(wrap);
                                            $('body').append(wrap2);
                                            if (left + $('.more-event-popup-wrap').width() > $(window).width()) {
                                                wrap2.css('margin-left', wrap2.width() * -1);
                                            }
                                        });
                                });
                            },
                            eventTemplate: $('#event-template').html(),
                            dataSource: schedulerDataSource,
                        });

                        // scheduler.refresh();

                        $('[aria-label=Previous]').attr('title', '이전 달');
                        $('[aria-label=Next]').attr('title', '다음 달');
                    }
                    var scheduler = $('#scheduler').data('kendoScheduler');
                    scheduler.setDataSource(schedulerDataSource);
                }
            </script>
        </div>
    </body>
</html>
