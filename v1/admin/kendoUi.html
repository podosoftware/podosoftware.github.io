<!doctype html>
<html lang="ko">
    <head>
        <!-- 여기에 head.html을 인클루드 -->
        <meta charset="UTF-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no" />
        <meta name="mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="#8C63E7" />

        <link rel="shortcut icon" href="" />
        <link rel="apple-touch-icon" href="" />
        <link rel="apple-touch-icon-precomposed" href="" />
        <link rel="icon" href="" type="image/x-icon" />

        <meta name="Description" content="" />
        <meta name="Keywords" content="" />
        <meta name="Copyright" content="" />
        <meta content="" property="og:title" />
        <meta content="" property="og:description" />
        <meta content="" property="og:url" />
        <meta content="" property="og:site-name" />

        <link rel="stylesheet" href="../css/reset2.css" />
        <link rel="stylesheet" href="../css/admin/root_admin.css" />
        <link rel="stylesheet" href="../css/kendo/2022.1.119/kendo.common.min.css" />
        <!--    <link rel="stylesheet" href="../css/font.css">-->
        <link rel="stylesheet" href="../css/common.css" />
        <link rel="stylesheet" href="../css/util.css" />
        <!--    <link rel="stylesheet" href="../css/style2.css">-->
        <link rel="stylesheet" href="../css/admin/admin.css" />
        <link rel="stylesheet" href="../css/guide.css" />
        <link rel="stylesheet" href="../css/media2.css" />

        <script src="../js/jquery/3.4.1/jquery-3.4.1.js"></script>
        <script src="../js/kendo/2022.1.119/kendo.all.min.js"></script>
        <script src="../js/kendo/2022.1.119/cultures/kendo.culture.ko-KR.min.js"></script>
        <script src="../js/kendo/kendo.messages.ko-KR.js"></script>
        <script src="../js/common2.js"></script>
        <script src="../js/front.js"></script>

        <link rel="stylesheet" href="../js/prism.css" />
        <script src="../js/prism.js"></script>

        <title>Kendo Ui - 관리자</title>
    </head>
    <body>
        <!-- 자동완성 방지용  -->
        <input type="text" title="자동완성 방지용" style="width: 0; height: 0; position: absolute" />
        <input type="password" title="자동완성 방지용" style="width: 0; height: 0; position: absolute" />
        <!-- 자동완성 방지용  -->

        <div class="wrap">
            <!--    Header START    -->
            <!-- 여기에 Header.html을 인클루드 -->
            <header class="left-header">
                <div class="left-header-top">
                    <h1 class="logo">
                        <a href="index.html"><img src="../images/logo.png" alt="로고" /></a>
                    </h1>
                </div>
                <nav class="left-header-menu-wrap">
                    <ul>
                        <!--            <li class="first css">-->
                        <!--                <a href="javascript: void(0);" class="tab">CSS</a>-->
                        <!--                <ol>-->
                        <!--                    <li class="liCss"><a href="css.html">Index</a></li>-->
                        <!--                </ol>-->
                        <!--            </li>-->
                        <li class="two util">
                            <a href="javascript: void(0);" class="tab">UTIL</a>
                            <ol>
                                <li class="liFont"><a href="util.html" data-hash="#font">font</a></li>
                                <li class="liMgPd"><a href="util_mgPd.html" data-hash="#mgPd">margin/padding</a></li>
                                <!--                    <li class="liColor"><a href="util_color.html" data-hash="#color">color</a></li>-->
                                <li class="liClamp"><a href="util_clamp.html" data-hash="#clamp">줄임표</a></li>
                                <li class="liFlex"><a href="util_flex.html" data-hash="#flex">flex</a></li>
                                <li class="liHide"><a href="util_hide.html" data-hash="#hide">hide</a></li>
                                <li class="liNoData"><a href="util_noData.html" data-hash="#noData">No Data</a></li>
                                <li class="liEtc"><a href="util_etc.html">Etc</a></li>
                                <!--                    <li><a href="util.html#skeleton">Skeleton</a></li>-->
                            </ol>
                        </li>
                        <li class="color">
                            <a href="javascript: void(0);" class="tab">COLOR</a>
                            <ol>
                                <li class="liColorPrimary"><a href="color_primary.html">Primary(theme)</a></li>
                                <li class="liColorText"><a href="color_text.html">Text</a></li>
                                <li class="liColorBg"><a href="color_bg.html">Background&Line</a></li>
                                <!--                    <li class="liColorBadge"><a href="color_badge.html">badge</a></li>-->
                                <!--                    <li class="liColorEtc"><a href="color_etc.html">etc</a></li>-->
                            </ol>
                        </li>
                        <li class="three button">
                            <a href="javascript: void(0);" class="tab">BUTTON</a>
                            <ol>
                                <li class="liContents"><a href="button.html" data-hash="#contents">Contents Buttons</a></li>
                                <li class="liSpliterContents"><a href="button_spliterCont.html" data-hash="#spliterRightContents">Spliter-Right Contents Buttons</a></li>
                            </ol>
                        </li>
                        <li class="input">
                            <a href="javascript: void(0);" class="tab">Input</a>
                            <ol>
                                <li class="liInput"><a href="input.html" data-hash="#input">Input box</a></li>
                                <li class="liInputNum"><a href="input_number.html" data-hash="#input">Input Number box</a></li>
                                <li class="liTextBox"><a href="input_textBox.html" data-hash="#textareaBox">Textarea box</a></li>
                                <li class="liChkRadio"><a href="input_checkRadio.html" data-hash="#checkRadio">Checkbox/Radio</a></li>
                            </ol>
                        </li>
                        <li class="four tab">
                            <a href="javascript: void(0);" class="tab">Tab</a>
                            <ol>
                                <li class="liTab"><a href="tab.html" data-hash="#popupTab">Popup Tab Style</a></li>
                                <li class="liSpliterTab"><a href="tab_spliterTab.html" data-hash="#spliterTab">Spliter-Right Tab Style</a></li>
                            </ol>
                        </li>
                        <li class="five popup">
                            <a href="javascript: void(0);" class="tab">Popup</a>
                            <ol>
                                <li class="liPopup"><a href="popup.html" data-hash="#style">Style</a></li>
                            </ol>
                        </li>
                        <li class="spliterRight">
                            <a href="javascript: void(0);" class="tab">Spliter-Right</a>
                            <ol>
                                <li class="liTitle"><a href="spliterRight.html" data-hash="#title">Title</a></li>
                                <li class="liTable"><a href="spliterRight_table.html#table" data-hash="#table">Contents Inner Table</a></li>
                                <!--                    <li class="liContInner"><a href="spliterRight_contInner.html#contentsInner" data-hash="#contentsInner">Contents Inner</a></li>-->
                            </ol>
                        </li>
                        <li class="searchArea">
                            <a href="javascript: void(0);" class="tab">Search Area</a>
                            <ol>
                                <li class="liArea"><a href="searchArea.html" data-hash="#area">Area</a></li>
                                <li class="liAreaBtn"><a href="searchArea_areaBtn.html" data-hash="#areaButtonBottom">검색버튼 영역 아래</a></li>
                                <li class="liTitleSearch"><a href="searchArea_titleSearch.html" data-hash="#titleSearch">Title Search</a></li>
                            </ol>
                        </li>
                        <li class="badge-">
                            <a href="javascript: void(0);" class="tab">Badge</a>
                            <ol>
                                <li class="liBadge"><a href="badge.html" data-hash="#badge">Badge</a></li>
                                <li class="liCurrent"><a href="badge_current.html" data-hash="#currentSituation">Current Situation</a></li>
                            </ol>
                        </li>
                        <li class="etc">
                            <a href="javascript: void(0);" class="tab">기타</a>
                            <ol>
                                <li class="liPay"><a href="etc.html" data-hash="#pay">결제관리</a></li>
                            </ol>
                        </li>
                        <li class="tips">
                            <a href="javascript: void(0);" class="tab">Tips</a>
                            <ol>
                                <li class="liTip"><a href="tips.html" data-hash="#tip">Tips</a></li>
                                <li class="liTip2"><a href="tips_tip2.html" data-hash="#tip2">운영관리 Tip</a></li>
                                <li class="liContTip"><a href="tips_contTip.html" data-hash="#contentsTip">선택항목 tip</a></li>
                                <li class="liTooltip"><a href="tips_tooltip.html" data-hash="#tooltip">Tooltip</a></li>
                                <li class="liContTip2"><a href="tips_contTip2.html" data-hash="#contTip">팝업 콘텐츠 Tip</a></li>
                            </ol>
                        </li>
                        <!--            <li class="kendoUi">-->
                        <!--                <a href="javascript: void(0);" class="tab">Kendo UI</a>-->
                        <!--                <ol>-->
                        <!--                    <li class="liUpload"><a href="admin_kendoUi.html" data-hash="#upload">Upload</a></li>-->
                        <!--                    <li class="liMulti"><a href="kendoUi_multi.html" data-hash="#multiselect">MultiSelect</a></li>-->
                        <!--                    <li class="liGrid"><a href="kendoUi_grid.html" data-hash="#gridFilterTooltip">Grid</a></li>-->
                        <!--                    <li class="liIcons"><a href="kendoUi_icons.html" data-hash="#icons">Icons</a></li>-->
                        <!--                    <li class="liDatePicker"><a href="admin_kendoUi_date.html" data-hash="#datePicker">DatePicker</a></li>-->
                        <!--                    <li class="liTime"><a href="kendoUi_time.html" data-hash="#dateTimePicker">DateTimePicker</a></li>-->
                        <!--                    <li class="liRange"><a href="kendoUi_range.html" data-hash="#dateRangePicker">DateRangePicker</a></li>-->
                        <!--&lt;!&ndash;                    <li class="liCalendar"><a href="kendoUi_calendar.html" data-hash="#calendar">Calendar</a></li>&ndash;&gt;-->
                        <!--                    <li class="liNumeric"><a href="kendoUi_numeric.html" data-hash="#numericTextBox">NumericTextBox</a></li>-->
                        <!--                    <li class="liDropDown"><a href="kendoUi_dropDown.html" data-hash="#dropDownList">DropDownList</a></li>-->
                        <!--                    <li class="liPaging"><a href="kendoUi_paging.html" data-hash="#paging">Paging</a></li>-->
                        <!--                    <li class="liEditor"><a href="kendoUi_editor.html" data-hash="#editor">Editor</a></li>-->
                        <!--                    <li class="liTree"><a href="kendoUi_tree.html" data-hash="#kendoTree">Kendo Tree</a></li>-->
                        <!--                </ol>-->
                        <!--            </li>-->
                    </ul>
                </nav>
            </header>

            <!--        <div id="header" data-include-path="header.html"></div>-->
            <!--    Header END    -->

            <!--    본문영역 START    -->
            <main class="body-container">
                <!--        breadcrumb START        -->
                <section class="breadcrumb">
                    <div class="container">
                        <ul class="menu">
                            <li>
                                <a href="index.html"><i class="icon-home"></i></a>
                            </li>
                            <li>Kendo Ui</li>
                        </ul>
                    </div>
                </section>
                <!--        breadcrumb END        -->

                <section class="sec-">
                    <div class="container">
                        <div class="top-title-box">
                            <h2>Kendo Ui</h2>
                        </div>
                        <p>업로드에는 그리드 형식과 리스트 형식이 있습니다.</p>
                        <p>관리자는 주로 그리드 형식을 사용합니다.</p>

                        <article id="uploadGrid" class="article-">
                            <h3 class="title"># Upload - 그리드 형식</h3>

                            <div class="sec-cont">
                                <div class="">
                                    <input type="hidden" id="objectId" value="1" />
                                    <div id="file_upload" class="hide"></div>
                                    <div id="file_grid" class="file-grid"></div>

                                    <div class="accordion-wrap mt30">
                                        <div class="accordion-head">
                                            <strong>코드 보기</strong>
                                        </div>
                                        <div class="accordion-body">
                                            <div class="g-code-box">
                                                <pre data-src="code/kendoUi_01.html"></pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!--                        //    -->
                            </div>
                        </article>
                        <!--                // Upload Grid End    -->

                        <article id="upload" class="article-">
                            <h3 class="title"># Upload - 리스트 형식</h3>

                            <div class="sec-cont">
                                <div class="">
                                    <input type="hidden" id="objectId2" value="1" />
                                    <div id="list_file_upload" class="hide my-file-upload"></div>
                                    <div id="list_file_grid" class="file-template"></div>

                                    <div class="accordion-wrap mt30">
                                        <div class="accordion-head">
                                            <strong>코드 보기</strong>
                                        </div>
                                        <div class="accordion-body">
                                            <div class="g-code-box">
                                                <pre data-src="code/kendoUi_02.html"></pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!--                        //    -->
                            </div>
                        </article>
                        <!--                // Upload List End    -->
                    </div>
                </section>
            </main>
            <!--    본문영역 END    -->

            <!--    Footer START    -->
            <!--    Footer END    -->

            <script type="text/x-kendo-template" id="fileupload_template">
                <input name="upload_file" id="upload_file" type="file"/>
            </script>

            <script type="text/x-kendo-template" id="list_fileupload_template">
                <input name="list_upload_file" id="list_upload_file" type="file"/>
            </script>

            <!-- 파일 템플릿 -->
            <script id="fileList" type="text/x-kendo-template">
                <tr>
                    <td colspan="2">
                        <div class="file-list">
                            <a href="/comm/download_my_attachment.do?attachmentId=#:attachmentId#" class="file-tit"><span class="file-icon"></span>#:name#</a>
                            <span class="file-size">#= commaStr(data.size) #byte</span>
                            <button class="del-file" onclick="deleteFile(#:attachmentId#, 'list_file_grid')"></button>
                        </div>
                    </td>
                </tr>
            </script>
            <!-- //파일 템플릿 -->

            <script>
                var now = new Date();
                var mon = '';
                var day = '';
                if (now.getMonth() + 1 < 10) {
                    mon = '0' + (now.getMonth() + 1);
                } else {
                    mon = now.getMonth() + 1;
                }
                if (now.getDate() < 10) {
                    day = '0' + now.getDate();
                } else {
                    day = now.getDate();
                }
                var nowDay = now.getFullYear() + '-' + mon + '-' + day;

                var currentPath = window.location.pathname;
                var currentHash = window.location.hash;

                $(function () {
                    kendo.culture('ko-KR');

                    $('.kendoUi .liUpload a').addClass('active');

                    // 파일업로드
                    fileGridDef('file_grid', 52);
                    fileUploaderDef('file_upload', 'uploadWindow', 52, 'fileupload_template', 'upload_file', 'file_grid');

                    listFileGridDef('list_file_grid', 52);
                    fileUploaderDef('list_file_upload', 'listUploadWindow', 52, 'list_fileupload_template', 'list_upload_file', 'list_file_grid');
                });

                var fileGridData = [{ name: '파일명.png', size: 123456, attachmentId: 123 }];

                //첨부파일 그리드 정의
                var fileGridDef = function (gridNm, objType) {
                    $('#' + gridNm).kendoGrid({
                        dataSource: fileGridData,
                        pageable: false,
                        selectable: false,
                        columns: [
                            {
                                field: 'name',
                                title: '파일명',
                                width: '120px',
                                headerAttributes: { class: 'table-header-cell', style: 'text-align: center;' },
                                attributes: { class: 'table-cell', style: 'text-align: left;' },
                            },
                            {
                                field: 'size',
                                title: '크기(byte)',
                                format: '{0:##,###}',
                                headerAttributes: { class: 'table-header-cell', style: 'text-align: center;' },
                                width: '100px',
                            },
                            {
                                width: '160px',
                                template: function (dataItem) {
                                    return (
                                        "<div class='grid-btn-box'><button onclick=\"location.href='<%= com.podosw.web.util.ServletUtils.getContextPath(request) %>/comm/download_my_attachment.do?attachmentId=" +
                                        dataItem.attachmentId +
                                        '\'" class="btn_inner k-button" style="text-decoration:none"><span>다운로드</span></button>' +
                                        '<button class="btn_inner k-button" onclick="deleteFile(\'' +
                                        objType +
                                        "', " +
                                        dataItem.attachmentId +
                                        ", '" +
                                        gridNm +
                                        '\')"><span>삭제</span></button></div>'
                                    );
                                },
                            },
                        ],
                        editable: false,
                        noRecords: {
                            template: "<div class='not-data-cont'><span>파일이 존재하지 않습니다.</span></div>",
                        },
                    });
                };

                //첨부파일 삭제.
                function deleteFile(objType, attachmentId, gname) {
                    if (confirm('첨부파일을 삭제 하시겠습니까?')) {
                        //첨부파일을 삭제 하시겠습니까?
                        //로딩바 생성.
                        //loadingOpen();
                        $.ajax({
                            type: 'POST',
                            url: '<%=com.podosw.web.util.ServletUtils.getContextPath(request)%>/comm/delete_my_attachment.do?output=json',
                            data: { attachmentId: attachmentId },
                            success: function (response) {
                                $('#' + gname)
                                    .data('kendoGrid')
                                    .dataSource.read();
                                //loadingClose();
                            },
                            error: podo.ui.handleAjaxError,
                            complete: function (xhr, statusText) {
                                //로딩바 제거.
                                //loadingClose();
                            },
                            dataType: 'json',
                        });
                    }
                }

                //첨부파일 업로드 컴포넌트 정의
                var fileUploaderDef = function (fileUploadDivTagId, uploadWindowId, objType, fileUploadTemplateId, uploadFileId, fileGridId) {
                    var ver = getInternetExplorerVersion();
                    if (ver > -1 && ver < 10) {
                        if ($('#' + fileUploadDivTagId).text().length == 0) {
                            var template = kendo.template('<button id="' + uploadWindowId + '" name="' + uploadWindowId + '">파일 업로드 하기</button>');
                            $('#' + fileUploadDivTagId).html(template({}));
                            $('#' + uploadWindowId).kendoButton({
                                click: function (e) {
                                    var width = 380;
                                    var height = 220;
                                    var left = (screen.width - width) / 2;
                                    var top = (screen.height - height) / 2;

                                    var windowUrl =
                                        '<%= com.podosw.web.util.ServletUtils.getContextPath(request) %>/comm/save_my_attachment.do?objectType=' + objType + '&objectId=' + $('#IMG_OBJECT_ID').val();
                                    myWindow = window.open(windowUrl, '_blank', 'toolbar=no, scrollbars=yes, resizable=yes, top=' + top + ', left=' + left + ', width=' + width + ', height=' + height);
                                },
                            });
                            $('#' + fileUploadDivTagId).removeClass('hide');
                        }
                    } else {
                        if ($('#' + fileUploadDivTagId).text().length == 0) {
                            var template = kendo.template($('#' + fileUploadTemplateId).html());
                            $('#' + fileUploadDivTagId).html(template({}));
                        }

                        $('#' + uploadFileId).kendoUpload({
                            showFileList: false,
                            width: 500,
                            multiple: false,
                            localization: { select: '파일 선택', statusUploaded: '완료.', statusFailed: '업로드 실패.' },
                            async: {
                                saveUrl: '<%= com.podosw.web.util.ServletUtils.getContextPath(request) %>/comm/save_my_attachment.do',
                                autoUpload: true,
                            },
                            upload: function (e) {
                                e.data = { objectType: objType, objectId: $('#objectId').val() };
                            },
                            error: function (e) {},
                            success: function (e) {
                                $('#' + fileGridId)
                                    .data('kendoGrid')
                                    .dataSource.read();

                                if (objType == '52') {
                                    //썸네일
                                    $('#thumbnailId').val(e.response.attachmentId);
                                }
                            },
                            select: function (e) {
                                var loginLogoFileGirdSize = $('#' + fileGridId)
                                    .data('kendoGrid')
                                    .dataSource.data().length;

                                if (loginLogoFileGirdSize > 0) {
                                    e.preventDefault();
                                    alert('이미 등록된 파일을 삭제 후 다시 시도해주세요.');
                                } else {
                                    $.each(e.files, function (index, value) {
                                        if (value.size > 10485760) {
                                            e.preventDefault();
                                            alert('파일 사이즈는 10M로 제한되어 있습니다.');
                                        } else {
                                            if (
                                                value.extension != '.JPG' &&
                                                value.extension != '.jpg' &&
                                                value.extension != '.GIF' &&
                                                value.extension != '.gif' &&
                                                value.extension != '.PNG' &&
                                                value.extension != '.png'
                                            ) {
                                                e.preventDefault();
                                                alert('이미지 파일만 선택해주세요.');
                                            }
                                        }
                                    });
                                }
                            },
                        });
                        $('#' + fileUploadDivTagId).removeClass('hide');
                    }
                };

                // 리스트 첨부파일 그리드 정의
                var listFileGridDef = function (gridNm, objType) {
                    $('#' + gridNm).kendoGrid({
                        dataSource: fileGridData,
                        pageable: false,
                        selectable: false,
                        scrollable: false,
                        editable: false,
                        columns: [{ field: 'name' }, { field: 'size' }],
                        rowTemplate: kendo.template($('#fileList').html()),
                        noRecords: {
                            template: "<div class='not-data-cont'><span>파일이 존재하지 않습니다.</span></div>",
                        },
                    });
                };
            </script>
        </div>
    </body>
</html>
